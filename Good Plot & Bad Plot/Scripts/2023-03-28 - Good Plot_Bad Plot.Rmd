---
title: "Good Plot/Bad Plot"
author: "Mikayla Kerchen"
date: "`r Sys.Date()`"
output: 
   html_document:
    toc_float: TRUE
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Libraries

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(gganimate)
library(ggimage)
library(magick)
```

## Load Data

```{r}
Honey_Data <- read.csv(here("Good Plot & Bad Plot", "Data", "honeyproduction.csv"))

glimpse(Honey_Data)
```

## Bad plot

```{r, echo=TRUE, results='hide'}
Honey_Data %>%
  ggplot(aes(x = priceperlb,
            y = yieldpercol,
            fill = year)) + 
  geom_col()+
  labs(title = "honey prod.")+
  scale_fill_gradient(low = "yellow", high = "#ac8405")+
  theme(panel.background = element_rect(fill = "#43382f"),
        plot.background = element_rect(fill = "#43382f"),
        axis.title.x = element_text(color = "#ac8405"),
        axis.title.y = element_text(color = "#ac8405"),
        axis.text = element_text(color = "yellow"),
        plot.title = element_text(color = "#ac8405"))
```

```{r, message=FALSE}
ggsave(here("Good Plot & Bad Plot", "Output", "BeePlot.png"))

bee <- image_read(here("Good Plot & Bad Plot","Output","Bee.png"))

beeplot<-image_read(here("Good Plot & Bad Plot","Output","BeePlot.png"))
beeout <- image_composite(beeplot, bee, offset = "+950+500")
beeout 
```

## What Makes the Bad Plot so **bad**?

-   No visible story to tell with the data
-   Too many bars that are unable to be differentiated from one another
-   No neat labels
-   An image that doesn't add anything to the plot
-   Unnecessary colors

## Good Plot

```{r}
Honey_Data %>%
  mutate(numcol = numcol/1000) %>%
  ggplot(aes(x = yieldpercol,
             y = priceperlb,
             size = numcol)) +
  geom_point(alpha=0.7,
             color ="#ac8405") +
  coord_flip()+
  scale_size(range = c(1.4, 13), name="Number of Colonies (per thousand)") +
  theme(legend.position="bottom") +
  labs(x = "Yield per Colony",
       y = "Price per Pound (lb.)") +
  transition_states(year,
     transition_length = 10, 
     state_length = 10)+
  ease_aes("cubic-in-out") +
  ggtitle('Honey Production in the United States',
          subtitle = 'Year: {closest_state}')

anim_save(here("Good Plot & Bad Plot", "Output", "Goodplot.gif"))
```

## Why is This Plot so Much *better*?

-   Has a story to tell with the data (animated by year)
-   Clearer data points
-   Neater labels
-   No unecessary images or colors to distract from the plot
